@if (_question != null)
{
    <div class="bg-black/70 top-0 left-0 bottom-0 right-0 absolute z-30" tabindex="0" @onkeydown="OnKeyDown" @ref="_bgElement">
        <div class="top-40 p-6 bg-white z-31 gap-10 mx-10 relative flex flex-col rounded-lg sm:mx-auto sm:max-w-[50%]">
            @_question.Message
            <div class="gap-5 flex justify-between">
                <button tabindex="2" class="button in-menu neutral" @onclick="() => OnOptionSelected(false)">@_question.DeclineOption</button>
                <button tabindex="1" class="button in-menu" @onclick="() => OnOptionSelected(true)">@_question.AgreeOption</button>
            </div>
        </div>
    </div>
}
@code {

    public record Question(string Message, string AgreeOption, string DeclineOption);

    private Question? _question;
    private Func<bool?, Task>? _callback;
    private ElementReference _bgElement;

    public async Task ShowAsync(Question question, Func<bool?, Task> callback)
    {
        _question = question;
        _callback = callback;
        StateHasChanged();
        await Task.Delay(200);
        await _bgElement.FocusAsync();
    }

    public void Hide()
    {
        _question = null;
        _callback = null;
        StateHasChanged();
    }

    private async Task OnOptionSelected(bool? option)
    {
        if (_callback != null) await _callback(option);
        Hide();
    }

    private async Task OnKeyDown(KeyboardEventArgs e)
    {
        if (e.Code == "Escape")
        {
            if (_callback != null) await _callback(null);
            Hide();
        }
    }

}
